<!DOCTYPE html>
<html>
<head>
    <title>数据导入</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        .message { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background-color: #dff0d8; color: #3c763d; }
        .error { background-color: #f2dede; color: #a94442; }
    </style>
</head>
<body>
    <div class="container">
        <h1>数据导入</h1>

        {% if message %}
        <div class="message success">{{ message }}</div>
        {% endif %}

        {% if error %}
        <div class="message error">{{ error }}</div>
        {% endif %}

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="form-group">
                <label for="data_type">数据类型:</label>
                <select id="data_type" name="data_type" required>
                    <option value="">-- 请选择 --</option>
                    <option value="student">学生信息</option>
                    <option value="teacher">教师信息</option>
                    <option value="course">课程信息</option>
                    <option value="enrollment">选课信息</option>  <!-- 新增选项 -->
                </select>
            </div>

            <div class="form-group">
                <label for="excel_file">Excel文件:</label>
                <input type="file" id="excel_file" name="excel_file" accept=".xlsx,.xls" required>
            </div>

            <button type="submit">导入数据</button>
        </form>

        <hr>

        <h3>下载模板:</h3>
        <ul>
            <li><a href="{% url 'download_template' 'student' %}">学生信息模板</a></li>
            <li><a href="{% url 'download_template' 'teacher' %}">教师信息模板</a></li>
            <li><a href="{% url 'download_template' 'course' %}">课程信息模板</a></li>
            <li><a href="{% url 'download_template' 'enrollment' %}">选课信息模板</a></li>  <!-- 新增链接 -->
        </ul>

        <!-- 在文件格式说明部分更新 -->
        <h3>Excel文件格式说明:</h3>
        <ul>
            <li><strong>学生信息</strong>: 学号, 姓名, 院系, 专业, 性别(M/F), 微信openid, 账号, 初始密码</li>
            <li><strong>教师信息</strong>: 工号, 姓名, 院系, 联系方式, 账号, 初始密码</li>
            <li><strong>课程信息</strong>: 课程代码, 课程名称, 开课院系, 教师工号, 上课时间</li>
            <li><strong>选课信息</strong>: 学号, 课程代码, 学期(如:2023-秋季)</li>
        </ul>
        <p>注意：第一行应为标题行，数据从第二行开始</p>
    </div>
</body>
</html>