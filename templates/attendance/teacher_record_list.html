<!DOCTYPE html>
<html>
<head>
    <title>{{ course.course_name }}考勤记录</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .stats { background: #f5f5f5; padding: 15px; margin-bottom: 20px; }
        .stats span { margin-right: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background: #f2f2f2; }
        .present { color: green; }
        .absent { color: red; }
        .late { color: orange; }
    </style>
</head>
<body>
    <div class="container">
        <h1>{{ course.course_name }} ({{ course.course_code }})</h1>
        <p>授课教师: {{ course.teacher.name }}</p>

        <div class="stats">
            <h3>考勤统计</h3>
            <span>总记录: {{ attendance_stats.total }}</span>
            <span class="present">出勤: {{ attendance_stats.present }}</span>
            <span class="absent">缺勤: {{ attendance_stats.absent }}</span>
        </div>

        <h2>考勤记录</h2>
        <table>
            <thead>
                <tr>
                    <th>日期</th>
                    <th>学号</th>
                    <th>姓名</th>
                    <th>状态</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody>
                {% for record in attendance_records %}
                <tr>
                    <td>{{ record.date|date:"Y-m-d" }}</td>
                    <td>{{ record.student.student_id }}</td>
                    <td>{{ record.student.name }}</td>
                    <td class="{{ record.status }}">
                        {% if record.status == 'present' %}出勤
                        {% elif record.status == 'absent' %}缺勤
                        {% endif %}
                    </td>
                    <td>{{ record.notes }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>请假记录</h2>
        <table>
            <thead>
                <tr>
                    <th>请假日期</th>
                    <th>学号</th>
                    <th>姓名</th>
                    <th>原因</th>
                    <th>状态</th>
                </tr>
            </thead>
            <tbody>
                {% for leave in leave_records %}
                <tr>
                    <td>{{ leave.leave_date|date:"Y-m-d" }}</td>
                    <td>{{ leave.student.student_id }}</td>
                    <td>{{ leave.student.name }}</td>
                    <td>{{ leave.reason }}</td>
                    <td>{% if leave.approved %}已批准{% else %}待审批{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <a href="{% url 'teacher_check_records' %}">返回查询</a>
    </div>
</body>
</html>